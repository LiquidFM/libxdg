<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>xdg: Binary cache of Desktop Entry Specification.</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">xdg
   &#160;<span id="projectnumber">0.2</span>
   </div>
   <div id="projectbrief">This library is implementation of several freedesktop.org specifications.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">index</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Binary cache of Desktop Entry Specification. </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The specification can be found <a href="http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html">here</a>.</p>
<p>This specification describes format of <em>".desktop"</em> and <em>".list"</em> files. Purpose of the library is to provide fastest possible access to contents of this files. This goal is achieved by using of AVL trees. They were chosen because AVL trees are more rigidly balanced than red-black trees, leading to slower insertion and removal but faster retrieval.</p>
<p>Files with data (<em>".desktop"</em> and <em>".list"</em> files) are stored in several different directories. Usually, according to the <a href="http://standards.freedesktop.org/basedir-spec/basedir-spec-latest.html">"Base Directory Specification"</a> there are, at least, two directories: one for user defined settings and one for system defined settings. In this regard, the library supports generation of binary cache files for each separate directory. Besides, during initialization, the library integrates information from different directories regardless the directory contains binary cache or not. This integration is very symbolic, because it's just placing pointers to the relevant AVL trees. At the same time, reading from the binary cache file doesn't use such functions as malloc and free, only mmap. In other words, the binary cache consists of constructed AVL trees and data stored in their nodes.</p>
<p>The file format of a binary cache looks as follows: </p>
<ul>
<li>
<p class="startli">4 <code>bytes</code> for version of a cache file.</p>
<p class="endli"></p>
</li>
<li>
List of <a class="el" href="structXdgFileWatcher.html">XdgFileWatcher</a> structures (at least one zeroed structure, i.e NULL-terminated C list). <br/>
 This list is used during loading of cache to determine validity of cache. <dl class="section see"><dt>See also:</dt><dd><a class="el" href="xdgapp_8h.html#a67692057236662507eae121b43659156">xdg_app_cache_file_is_valid()</a> <br/>
 <a class="el" href="xdgapp_8h.html#acf70d45bb83b91e72a93c5d07318857f">xdg_app_refresh()</a></dd></dl>
</li>
<li>
AVL tree of all <em>".desktop"</em> files located in the same directory (and subdirectories) as cache file. <br/>
 Each key of this tree is a name of <em>".desktop"</em> file (e.g. <em>kde4-kate.desktop</em>). <br/>
 Each value of this tree is an AVL tree of <a class="el" href="structXdgApp.html">XdgApp</a> items, which in turns is an AVL tree of <a class="el" href="structXdgAppGroup.html">XdgAppGroup</a> items, which is an AVL tree of <a class="el" href="structXdgAppGroupEntry.html">XdgAppGroupEntry</a> items. <dl class="section note"><dt>Note:</dt><dd>This tree serves as a container of <em>".desktop"</em> files for the two other trees in cache.</dd></dl>
</li>
<li>
AVL tree of associations of mime type with <em>".desktop"</em> files. <br/>
 Each key of this tree is a name of the first part of mime type (e.g. <em>text</em>). <br/>
 Each value of this tree is an AVL tree of a second part of mime type (e.g. <em>html</em>), which contains a list of pointers to <a class="el" href="structXdgApp.html">XdgApp</a> items. <dl class="section note"><dt>Note:</dt><dd>This tree stores connections between a certain <em>".desktop"</em> file and mime types. </dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="xdgapp_8h.html#af74b63e575298b2ce9a8e57fbacd4855">xdg_known_apps_lookup()</a></dd></dl>
</li>
<li>
AVL tree of all <em>".list"</em> files located in the same directory (and subdirectories) as cache file. <br/>
 Each key of this tree is a name of a group from <em>".list"</em> file (e.g. <em>Default</em> <em>Applications</em>). <br/>
 Each value of this tree is an AVL tree of entries, which in it's turn is an AVL tree of {mime type, <em>".desktop"</em> files} pairs in the format: <br/>
<em>"text/plain=kde4-kate.desktop;diffuse.desktop;"</em>. <dl class="section note"><dt>Note:</dt><dd>This tree stores connections (known from <em>".list"</em> files) between a certain <em>".desktop"</em> file and mime types. </dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="xdgapp_8h.html#aaad229dea73735dc7ec2ef7e693da92a">xdg_default_apps_lookup()</a> <br/>
 <a class="el" href="xdgapp_8h.html#a5d96b1573dce1803112daf648655e6bf">xdg_added_apps_lookup()</a> <br/>
 <a class="el" href="xdgapp_8h.html#a83884641cb8729a6eb35c19b4414cb56">xdg_removed_apps_lookup()</a> </dd></dl>
</li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jul 1 2012 23:52:51 for xdg by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1
</small></address>
</body>
</html>
